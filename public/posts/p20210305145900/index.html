<!DOCTYPE html>
<html lang="en-us" dir="ltr">
<head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
  



  
  


<head lang="en-us">
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
  <meta name="HandheldFriendly" content="True" />
  <meta name="MobileOptimized" content="320" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="color-scheme" content="dark light">
  <meta name="description" content="How to split main.c into .h and .c files

This post is updated on July 29, 2024, with cotent as below:
For a C project which has directory as below:
├── CMakeLists.txt
├── README.md
└── main
    ├── CMakeLists.txt
    └── main.c
How to split the main.c into me.h and me.c and let all the declarations and definitions be in the .h and .c file respectively?
1. Understand the process of compilation and linking
1.1 Pre-processing 预处理
在编译开始之前，预处理器会处理代码中的预处理指令，比如 #include、#define 和条件编译指令 (#ifdef、#endif 等)。" />
  <meta name="author" content="Hugo Author">
  <meta name="keywords" content="">
  <title>split your cpp code into multiple files | Combine Art and Sciences</title>
  <link rel="canonical" href="http://localhost:1313/posts/p20210305145900/" />
  

  
  <meta property="og:type" content="article" />
  <meta property="og:description" content="How to split main.c into .h and .c files

This post is updated on July 29, 2024, with cotent as below:
For a C project which has directory as below:
├── CMakeLists.txt
├── README.md
└── main
    ├── CMakeLists.txt
    └── main.c
How to split the main.c into me.h and me.c and let all the declarations and definitions be in the .h and .c file respectively?
1. Understand the process of compilation and linking
1.1 Pre-processing 预处理
在编译开始之前，预处理器会处理代码中的预处理指令，比如 #include、#define 和条件编译指令 (#ifdef、#endif 等)。" />
  <meta property="og:title" content="split your cpp code into multiple files" />
  <meta property="og:site_name" content="Combine Art and Sciences" />
  <meta property="og:image:type" content="image/jpeg" />
  <meta property="og:url" content="http://localhost:1313/posts/p20210305145900/" />
  <meta property="og:locale" content="en-us" />

  
    <meta property="article:published_time" content="2024-07-30" />
    <meta property="article:modified_time" content="2024-07-30" />
    
  

  
  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="split your cpp code into multiple files | Combine Art and Sciences" />
  <meta name="twitter:description" content="How to split main.c into .h and .c files

This post is updated on July 29, 2024, with cotent as below:
For a C project which has directory as below:
├── CMakeLists.txt
├── README.md
└── main
    ├── CMakeLists.txt
    └── main.c
How to split the main.c into me.h and me.c and let all the declarations and definitions be in the .h and .c file respectively?
1. Understand the process of compilation and linking
1.1 Pre-processing 预处理
在编译开始之前，预处理器会处理代码中的预处理指令，比如 #include、#define 和条件编译指令 (#ifdef、#endif 等)。" />
  <meta name="twitter:domain" content="http://localhost:1313/posts/p20210305145900/" />

  
  
    <link rel="icon" href="http://localhost:1313/favicon.ico">
  
  
  
  

  
  <link rel="stylesheet" href="//cdn.jsdelivr.net/npm/modern-normalize/modern-normalize.min.css">

  
  
  

  

  
    <link rel="stylesheet" href="http://localhost:1313/style.css" rel="preload stylesheet" as="style"/>
  

  
  
</head>

</head>
<body>
  <header>
    <header id="header">
  <div class="row">
    <div class="container has-padding nav">
      <button id="navbar-toggler" class="navbar-button" aria-hidden="true">











<svg xmlns='http://www.w3.org/2000/svg' class='ionicon' viewBox='0 0 512 512'><path d='M64 384h384v-42.67H64zm0-106.67h384v-42.66H64zM64 128v42.67h384V128z'/></svg>





</button>
      <div class="navbar-brand">
        <a class="logo navbar-button" href="http://localhost:1313/" title="Combine Art and Sciences">
          <span>Combine Art and Sciences</span>
        </a>
      </div>
      <nav class="navbar" role="navigation">
        <ul>
          
          
            <li class="nav-bar-item active">
              <a class="nav-link navbar-button" href="/posts/" title="posts">
                <span>posts</span>
              </a>
            </li>
          
            <li class="nav-bar-item">
              <a class="nav-link navbar-button" href="/tags/" title="tags">
                <span>tags</span>
              </a>
            </li>
          
            <li class="nav-bar-item">
              <a class="nav-link navbar-button" href="/archives/" title="archives">
                <span>archives</span>
              </a>
            </li>
          
            <li class="nav-bar-item">
              <a class="nav-link navbar-button" href="/about/" title="about">
                <span>about</span>
              </a>
            </li>
          
        </ul>
      </nav>
      <div class="theme-selector">
        <button class="button is-text" id="theme-selector-button" title="toggle theme">
          <span class="label icon">





<svg xmlns='http://www.w3.org/2000/svg' class='ionicon' viewBox='0 0 512 512'><path d='M256 32C132.29 32 32 132.29 32 256s100.29 224 224 224 224-100.29 224-224S379.71 32 256 32zM128.72 383.28A180 180 0 01256 76v360a178.82 178.82 0 01-127.28-52.72z'/></svg>











</span>
        </button>
      </div>
    </div>
    
      <div class="container has-padding">
        <div class="breadcrumb">
          
<ol  class="breadcrumb-nav">
  

  

  

<li >
  <a href="http://localhost:1313/">Home</a>
</li>


<li >
  <a href="http://localhost:1313/posts/">Posts</a>
</li>


<li class="active">
  <a href="http://localhost:1313/posts/p20210305145900/">split your cpp code into multiple files</a>
</li>

</ol>




        </div>
      </div>
    
  </div>
</header>

  </header>
  <main>
    

<main id="main">
  <div class="container has-padding">
    <div class="article-card post single">
      <h1 class="title">split your cpp code into multiple files</h1>
      <div class="post-info">
        <span>



<svg xmlns='http://www.w3.org/2000/svg' class='ionicon' viewBox='0 0 512 512'><path d='M32 456a24 24 0 0024 24h400a24 24 0 0024-24V176H32zm320-244a4 4 0 014-4h40a4 4 0 014 4v40a4 4 0 01-4 4h-40a4 4 0 01-4-4zm0 80a4 4 0 014-4h40a4 4 0 014 4v40a4 4 0 01-4 4h-40a4 4 0 01-4-4zm-80-80a4 4 0 014-4h40a4 4 0 014 4v40a4 4 0 01-4 4h-40a4 4 0 01-4-4zm0 80a4 4 0 014-4h40a4 4 0 014 4v40a4 4 0 01-4 4h-40a4 4 0 01-4-4zm0 80a4 4 0 014-4h40a4 4 0 014 4v40a4 4 0 01-4 4h-40a4 4 0 01-4-4zm-80-80a4 4 0 014-4h40a4 4 0 014 4v40a4 4 0 01-4 4h-40a4 4 0 01-4-4zm0 80a4 4 0 014-4h40a4 4 0 014 4v40a4 4 0 01-4 4h-40a4 4 0 01-4-4zm-80-80a4 4 0 014-4h40a4 4 0 014 4v40a4 4 0 01-4 4h-40a4 4 0 01-4-4zm0 80a4 4 0 014-4h40a4 4 0 014 4v40a4 4 0 01-4 4h-40a4 4 0 01-4-4zM456 64h-55.92V32h-48v32H159.92V32h-48v32H56a23.8 23.8 0 00-24 23.77V144h448V87.77A23.8 23.8 0 00456 64z'/></svg>













<time datetime=2024-07-30T09:22:00&#43;0800 class="date">July 30, 2024</time></span>
        <span>
















<svg xmlns='http://www.w3.org/2000/svg' class='ionicon' viewBox='0 0 512 512'><path d='M256 48C141.13 48 48 141.13 48 256c0 114.69 93.32 208 208 208 114.86 0 208-93.14 208-208 0-114.69-93.31-208-208-208zm108 240H244a4 4 0 01-4-4V116a4 4 0 014-4h24a4 4 0 014 4v140h92a4 4 0 014 4v24a4 4 0 01-4 4z'/></svg>
8 mins to read</span>
        
          <span>












<svg xmlns='http://www.w3.org/2000/svg' class='ionicon' viewBox='0 0 512 512'><path d='M256 256a112 112 0 10-112-112 112 112 0 00112 112zm0 32c-69.42 0-208 42.88-208 128v64h416v-64c0-85.12-138.58-128-208-128z'/></svg>




Hugo Author</span>
        
        
        
          <span>posts </span>
        
      </div>
      <article class="post-entry content">
        
          <h1 id="how-to-split-mainc-into-h-and-c-files">How to split main.c into .h and .c files<a hidden class="heading-anchor" aria-hidden="true" href="#how-to-split-mainc-into-h-and-c-files">#</a></h1>
<blockquote>
<p>This post is updated on July 29, 2024, with cotent as below:</p></blockquote>
<p>For a C project which has directory as below:</p>
<pre tabindex="0"><code>├── CMakeLists.txt
├── README.md
└── main
    ├── CMakeLists.txt
    └── main.c
</code></pre><p>How to split the <code>main.c</code> into <code>me.h</code> and <code>me.c</code> and let all the declarations and definitions be in the .<code>h</code> and <code>.c</code> file respectively?</p>
<h3 id="1-understand-the-process-of-compilation-and-linking">1. Understand the process of compilation and linking<a hidden class="heading-anchor" aria-hidden="true" href="#1-understand-the-process-of-compilation-and-linking">#</a></h3>
<h4 id="11-pre-processing-预处理">1.1 Pre-processing 预处理<a hidden class="heading-anchor" aria-hidden="true" href="#11-pre-processing-预处理">#</a></h4>
<p>在编译开始之前，预处理器会处理代码中的预处理指令，比如 <code>#include</code>、<code>#define</code> 和条件编译指令 (<code>#ifdef</code>、<code>#endif</code> 等)。</p>
<p>预处理的主要任务是：</p>
<ul>
<li><strong>包含头文件</strong>：预处理器会查找 <code>#include</code> 指令指定的头文件，并<strong>将这些文件的内容插入</strong>到包含指令的位置。例如，<code>#include &quot;me.h&quot;</code> 会把 <code>me.h</code> 文件的内容插入到 <code>main.c</code> 文件中。</li>
<li><strong>宏展开</strong>：所有的宏定义（使用 <code>#define</code>）会被展开到其实际的值。</li>
<li><strong>条件编译</strong>：根据条件编译指令（如 <code>#ifdef</code>、<code>#if</code>）决定是否编译特定的代码部分。</li>
</ul>
<h4 id="12-complilation-编译">1.2 Complilation 编译<a hidden class="heading-anchor" aria-hidden="true" href="#12-complilation-编译">#</a></h4>
<p>在预处理之后，编译器会将每个源文件（.c 文件）编译成目标文件（.o 文件）。编译的过程包括：语法分析、生成中间代码、优化、生成目标代码（.o 文件，尚未链接）。其中，从中间代码到目标代码，是由assembly汇编步骤完成的。汇编的过程包括：将中间代码转换为汇编语言代码；将汇编语言代码转换为机器码，存储在目标文件中。</p>
<h4 id="13-linking-链接">1.3 Linking 链接<a hidden class="heading-anchor" aria-hidden="true" href="#13-linking-链接">#</a></h4>
<p>在编译阶段完成后，所有生成的目标文件（.o 文件）和库文件（.a 或 .lib 文件）会被链接器（Linker）链接在一起，生成最终的可执行文件（.elf、.exe 等）。链接的过程包括：</p>
<ul>
<li><strong>符号解析</strong>：链接器会解析目标文件中的符号（函数名、变量名等），并将这些符号与其他目标文件或库中的符号对应起来。</li>
<li><strong>重定位</strong>：链接器会调整目标文件中的地址，使它们指向正确的位置。</li>
<li><strong>生成可执行文件</strong>：将所有目标文件和库文件链接在一起，生成最终的可执行文件。</li>
</ul>
<h3 id="2-understanding-build-system">2. Understanding Build System<a hidden class="heading-anchor" aria-hidden="true" href="#2-understanding-build-system">#</a></h3>
<p>有必要理解构建系统 Build System 的相关概念：</p>
<p>构建系统（如 CMake、Makefile）负责管理整个构建过程，它会自动执行以下任务：</p>
<ul>
<li><strong>查找文件</strong>：根据项目的配置（如 CMakeLists.txt），查找所有需要编译的源文件和头文件。</li>
<li><strong>生成构建规则</strong>：根据项目的配置文件生成编译、汇编和链接的规则。</li>
<li><strong>执行构建</strong>：按照生成的规则执行编译、汇编和链接过程，生成最终的可执行文件或库文件。</li>
</ul>
<h3 id="3--how-will-they-handle-on-this-example-proj">3 . How will they handle on this example proj.<a hidden class="heading-anchor" aria-hidden="true" href="#3--how-will-they-handle-on-this-example-proj">#</a></h3>
<p>以开场时项目结构为例，假设使用 CMake 构建系统：</p>
<p><strong>预处理阶段</strong>：</p>
<ul>
<li><code>main.c</code> 中插入 <code>#include &quot;me.h&quot;</code> ，该 <code>#include</code> 被处理，<code>me.h</code> 的内容被插入到 <code>main.c</code> 中。</li>
<li><code>me.c</code> 中插入 <code>#include &quot;me.h&quot;</code> ，该 <code>#include</code> 被处理，<code>me.h</code> 的内容被插入到 <code>me.c</code> 中。</li>
</ul>
<p><strong>编译汇编阶段</strong>：</p>
<ul>
<li><code>main.c</code> 和 <code>me.c</code> 被编译成目标文件（如 <code>main.o</code> 和 <code>me.o</code>）。</li>
</ul>
<p><strong>链接阶段</strong>：</p>
<ul>
<li>链接器将 <code>main.o</code> 和 <code>me.o</code> 以及其他必要的库文件链接在一起，生成最终的可执行文件（例如 <code>your_project.elf</code>）。</li>
</ul>
<p><strong>构建系统作用</strong>：</p>
<ul>
<li>CMake 根据 <code>CMakeLists.txt</code> 文件生成编译和链接规则，然后调用编译器和链接器执行这些规则，最终生成可执行文件。</li>
</ul>
<h3 id="4-实操">4. 实操<a hidden class="heading-anchor" aria-hidden="true" href="#4-实操">#</a></h3>
<p><code>main.c</code> 源文件内容如下：</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="cm">/* Blink Example */</span>
</span></span><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&lt;stdio.h&gt;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&#34;freertos/FreeRTOS.h&#34;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&#34;freertos/task.h&#34;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&#34;driver/gpio.h&#34;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&#34;esp_log.h&#34;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&#34;led_strip.h&#34;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&#34;sdkconfig.h&#34;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp"></span>
</span></span><span class="line"><span class="cl"><span class="cm">/* Macro definitions */</span>
</span></span><span class="line"><span class="cl"><span class="cp">#define BLINK_GPIO 12
</span></span></span><span class="line"><span class="cl"><span class="cp">#define GPIO_MODE_OUTPUT 1
</span></span></span><span class="line"><span class="cl"><span class="cp">#define CONFIG_BLINK_PERIOD 1000
</span></span></span><span class="line"><span class="cl"><span class="cp"></span>
</span></span><span class="line"><span class="cl"><span class="c1">// declarations and definitions
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">static</span> <span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">TAG</span> <span class="o">=</span> <span class="s">&#34;example&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">static</span> <span class="kt">uint8_t</span> <span class="n">s_led_state</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">static</span> <span class="kt">void</span> <span class="nf">blink_led</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="cm">/* Set the GPIO level according to the state (LOW or HIGH)*/</span>
</span></span><span class="line"><span class="cl">    <span class="nf">gpio_set_level</span><span class="p">(</span><span class="n">BLINK_GPIO</span><span class="p">,</span> <span class="n">s_led_state</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">static</span> <span class="kt">void</span> <span class="nf">configure_led</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nf">ESP_LOGI</span><span class="p">(</span><span class="n">TAG</span><span class="p">,</span> <span class="s">&#34;Example configured to blink GPIO LED!&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="nf">gpio_reset_pin</span><span class="p">(</span><span class="n">BLINK_GPIO</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="cm">/* Set the GPIO as a push/pull output */</span>
</span></span><span class="line"><span class="cl">    <span class="nf">gpio_set_direction</span><span class="p">(</span><span class="n">BLINK_GPIO</span><span class="p">,</span> <span class="n">GPIO_MODE_OUTPUT</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kt">void</span> <span class="nf">app_main</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="cm">/* Configure the peripheral according to the LED type */</span>
</span></span><span class="line"><span class="cl">    <span class="nf">configure_led</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">while</span> <span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nf">ESP_LOGI</span><span class="p">(</span><span class="n">TAG</span><span class="p">,</span> <span class="s">&#34;Turning the LED %s!&#34;</span><span class="p">,</span> <span class="n">s_led_state</span> <span class="o">==</span> <span class="nb">true</span> <span class="o">?</span> <span class="s">&#34;ON&#34;</span> <span class="o">:</span> <span class="s">&#34;OFF&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="nf">blink_led</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">        <span class="cm">/* Toggle the LED state */</span>
</span></span><span class="line"><span class="cl">        <span class="n">s_led_state</span> <span class="o">=</span> <span class="o">!</span><span class="n">s_led_state</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="nf">vTaskDelay</span><span class="p">(</span><span class="n">CONFIG_BLINK_PERIOD</span> <span class="o">/</span> <span class="n">portTICK_PERIOD_MS</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>将 <code>main/main.c</code> 文件重构，将 <code>#include</code> 部分和函数声明移到新的 <code>me.h</code> 头文件，将函数定义移到新的 <code>me.c</code> 源文件，并在 <code>main.c</code> 文件中保留 <code>app_main()</code> 函数。</p>
<h4 id="41-创建-meh">4.1 创建 <code>me.h</code><a hidden class="heading-anchor" aria-hidden="true" href="#41-创建-meh">#</a></h4>
<p>在 <code>main</code> 目录下创建一个名为 <code>me.h</code> 的头文件，内容如下：</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="cp">#ifndef ME_H
</span></span></span><span class="line"><span class="cl"><span class="cp">#define ME_H
</span></span></span><span class="line"><span class="cl"><span class="cp"></span>
</span></span><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&lt;stdio.h&gt;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&#34;freertos/FreeRTOS.h&#34;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&#34;freertos/task.h&#34;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&#34;driver/gpio.h&#34;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&#34;esp_log.h&#34;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&#34;led_strip.h&#34;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&#34;sdkconfig.h&#34;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp"></span>
</span></span><span class="line"><span class="cl"><span class="cm">/* Define GPIO and other configuration settings */</span>
</span></span><span class="line"><span class="cl"><span class="cp">#define BLINK_GPIO 12
</span></span></span><span class="line"><span class="cl"><span class="cp">#define GPIO_MODE_OUTPUT 1
</span></span></span><span class="line"><span class="cl"><span class="cp">#define CONFIG_BLINK_PERIOD 1000
</span></span></span><span class="line"><span class="cl"><span class="cp"></span>
</span></span><span class="line"><span class="cl"><span class="cm">/* replace `static` into `extern` for globally ref */</span>
</span></span><span class="line"><span class="cl"><span class="k">extern</span> <span class="kt">uint8_t</span> <span class="n">s_led_state</span><span class="p">;</span>  <span class="c1">//static uint8_t s_led_state = 0 (in oirigin main.c)
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">extern</span> <span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">TAG</span><span class="p">;</span>  <span class="c1">// can not define the value with ` = &#34;example&#34; `
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl"><span class="cm">/* remove `static` for globally ref */</span>
</span></span><span class="line"><span class="cl"><span class="kt">void</span> <span class="nf">blink_led</span><span class="p">(</span><span class="kt">void</span><span class="p">);</span>     <span class="c1">// static void blink_led(void){} ,,in oirigin main.c  
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kt">void</span> <span class="nf">configure_led</span><span class="p">(</span><span class="kt">void</span><span class="p">);</span> <span class="c1">// static void configure_led(void) ,,in oirigin main.c 
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl"><span class="cp">#endif </span><span class="cm">/* ME_H */</span><span class="cp">
</span></span></span></code></pre></div><h4 id="42-创建-mec">4.2. 创建 <code>me.c</code><a hidden class="heading-anchor" aria-hidden="true" href="#42-创建-mec">#</a></h4>
<p>在 <code>main</code> 目录下创建一个名为 <code>me.c</code> 的源文件，内容如下：</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&#34;me.h&#34;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp"></span>
</span></span><span class="line"><span class="cl"><span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">TAG</span> <span class="o">=</span> <span class="s">&#34;example&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="kt">uint8_t</span> <span class="n">s_led_state</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="c1">// enabled here, but can also be refered by main.c
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl"><span class="kt">void</span> <span class="nf">blink_led</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span>  <span class="o">//</span><span class="k">static</span> <span class="kt">void</span> <span class="nf">blink_led</span><span class="p">(</span><span class="kt">void</span><span class="p">){}</span> <span class="p">,,</span><span class="n">in</span> <span class="n">main</span><span class="p">.</span><span class="n">c</span> <span class="n">originally</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nf">gpio_set_level</span><span class="p">(</span><span class="n">BLINK_GPIO</span><span class="p">,</span> <span class="n">s_led_state</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kt">void</span> <span class="nf">configure_led</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span> <span class="c1">//static void configure_led(void){} ,,in main.c originally
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nf">ESP_LOGI</span><span class="p">(</span><span class="n">TAG</span><span class="p">,</span> <span class="s">&#34;Example configured to blink GPIO LED!&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="nf">gpio_reset_pin</span><span class="p">(</span><span class="n">BLINK_GPIO</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="nf">gpio_set_direction</span><span class="p">(</span><span class="n">BLINK_GPIO</span><span class="p">,</span> <span class="n">GPIO_MODE_OUTPUT</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><h4 id="43-修改-mainc">4.3. 修改 <code>main.c</code><a hidden class="heading-anchor" aria-hidden="true" href="#43-修改-mainc">#</a></h4>
<p>更新 <code>main.c</code> 文件，只保留 <code>app_main()</code> 函数，并包含 <code>me.h</code> 文件：</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&#34;me.h&#34;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp"></span>
</span></span><span class="line"><span class="cl"><span class="kt">void</span> <span class="nf">app_main</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="cm">/* Configure the peripheral according to the LED type */</span>
</span></span><span class="line"><span class="cl">    <span class="nf">configure_led</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">while</span> <span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nf">ESP_LOGI</span><span class="p">(</span><span class="n">TAG</span><span class="p">,</span> <span class="s">&#34;Turning the LED %s!&#34;</span><span class="p">,</span> <span class="n">s_led_state</span> <span class="o">==</span> <span class="nb">true</span> <span class="o">?</span> <span class="s">&#34;ON&#34;</span> <span class="o">:</span> <span class="s">&#34;OFF&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="nf">blink_led</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">        <span class="cm">/* Toggle the LED state */</span>
</span></span><span class="line"><span class="cl">        <span class="n">s_led_state</span> <span class="o">=</span> <span class="o">!</span><span class="n">s_led_state</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="nf">vTaskDelay</span><span class="p">(</span><span class="n">CONFIG_BLINK_PERIOD</span> <span class="o">/</span> <span class="n">portTICK_PERIOD_MS</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><h4 id="44-修改-cmakeliststxt">4.4. 修改 <code>CMakeLists.txt</code><a hidden class="heading-anchor" aria-hidden="true" href="#44-修改-cmakeliststxt">#</a></h4>
<p>在 <code>main</code> 目录下的 <code>CMakeLists.txt</code> 文件中，添加新的 <code>me.c</code> 文件：</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-cmake" data-lang="cmake"><span class="line"><span class="cl"><span class="c"># idf_component_register(
</span></span></span><span class="line"><span class="cl"><span class="c">#           SRCS &#34;main.c&#34;
</span></span></span><span class="line"><span class="cl"><span class="c">#           INCLUDE_DIRS &#34;.&#34;
</span></span></span><span class="line"><span class="cl"><span class="c">#)
</span></span></span><span class="line"><span class="cl"><span class="c"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="nb">idf_component_register</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="s">SRCS</span> <span class="s2">&#34;main.c&#34;</span> <span class="s2">&#34;me.c&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="s">INCLUDE_DIRS</span> <span class="s2">&#34;.&#34;</span>
</span></span><span class="line"><span class="cl"><span class="p">)</span><span class="err">
</span></span></span></code></pre></div><h3 id="总结">总结<a hidden class="heading-anchor" aria-hidden="true" href="#总结">#</a></h3>
<ol>
<li><strong><code>me.h</code></strong> 文件：包含了头文件、宏定义和函数声明。</li>
<li><strong><code>me.c</code></strong> 文件：包含了 <code>blink_led()</code> 和 <code>configure_led()</code> 函数的实现。</li>
<li><strong><code>main.c</code></strong> 文件：仅包含 <code>app_main()</code> 函数，并引用 <code>me.h</code> 头文件。</li>
<li><strong><code>CMakeLists.txt</code></strong> 文件：更新以包括 <code>me.c</code> 源文件。</li>
</ol>
<p>这样，您的代码将更加模块化，易于维护。</p>
<h3 id="faq">FAQ:<a hidden class="heading-anchor" aria-hidden="true" href="#faq">#</a></h3>
<h4 id="faq1-有关-static-关键字extern-关键字">FAQ1: 有关 static 关键字、extern 关键字<a hidden class="heading-anchor" aria-hidden="true" href="#faq1-有关-static-关键字extern-关键字">#</a></h4>
<pre tabindex="0"><code>我注意到在 main/blink_example_main.c 文件中的static void blink_led(void)函数名，移动到me.h进行声明以后，‘static&#39;不见了，是什么原因？
</code></pre><blockquote>
<h3 id="quick-answer">Quick Answer:<a hidden class="heading-anchor" aria-hidden="true" href="#quick-answer">#</a></h3>
<ul>
<li>在 .h 头文件中，只声明函数，不需要 <code>static</code> 关键字。</li>
<li>在源文件中定义函数时，如果希望函数仅在当前源文件中可见，要使用 <code>static</code> 关键字；如果函数需要在其他源文件中使用，则不要使用 <code>static</code>。</li>
<li><code>extern</code> 关键字用于常量变量的全局共享。</li>
</ul>
<h3 id="normal-answer">Normal Answer:<a hidden class="heading-anchor" aria-hidden="true" href="#normal-answer">#</a></h3>
<p>在 C 语言中，<code>static</code> 关键字有不同的作用，具体取决于它的使用上下文。下面是 <code>static</code> 关键字的作用和原因：</p>
<h4 id="static-关键字的作用"><code>static</code> 关键字的作用<a hidden class="heading-anchor" aria-hidden="true" href="#static-关键字的作用">#</a></h4>
<ol>
<li><strong>在函数内部</strong>：<code>static</code> 关键字用于定义静态局部变量，这些变量在函数调用结束后不会被销毁，其值会被保留到下次调用函数时。</li>
<li><strong>在函数外部（文件级别）</strong>：<code>static</code> 关键字用于定义静态函数或静态全局变量，这样的函数或变量只能在定义它的源文件内部使用，不能在其他源文件中引用。</li>
</ol>
<h4 id="为什么在头文件中移除-static-关键字">为什么在头文件中移除 <code>static</code> 关键字<a hidden class="heading-anchor" aria-hidden="true" href="#为什么在头文件中移除-static-关键字">#</a></h4>
<p>在头文件中，只需要声明函数，而不需要定义它。声明函数时，通常不使用 <code>static</code> 关键字。原因如下：</p>
<ul>
<li><strong>函数声明</strong>：函数声明告诉编译器函数的存在和其接口（返回类型、参数类型等），但不提供函数的实现。声明函数时不需要 <code>static</code>，因为函数的定义可能会在其他源文件中找到，且可能会被多个源文件引用。</li>
<li><strong>函数定义</strong>：函数定义提供了函数的具体实现。如果一个函数定义为 <code>static</code>，它的作用范围仅限于定义它的源文件，不能在其他源文件中引用。因此，<code>static</code> 关键字在函数定义中用来限制函数的链接性，防止外部源文件引用。</li>
</ul>
<h4 id="具体到本节的情况">具体到本节的情况<a hidden class="heading-anchor" aria-hidden="true" href="#具体到本节的情况">#</a></h4>
<p>在 <code>me.h</code> 头文件中，需要声明 <code>blink_led()</code> 和 <code>configure_led()</code> 函数，以便<em>其他源文件可以使用</em>这些函数。因此，头文件中只包含函数声明，不需要 <code>static</code> 关键字。<code>static</code> 关键字的作用是将函数的链接限制在源文件内部，这在头文件中是不适用的。</p>
<h4 id="示例">示例<a hidden class="heading-anchor" aria-hidden="true" href="#示例">#</a></h4>
<p><strong>在头文件 <code>me.h</code> 中声明函数：</strong></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="cp">#ifndef ME_H
</span></span></span><span class="line"><span class="cl"><span class="cp">#define ME_H
</span></span></span><span class="line"><span class="cl"><span class="cp"></span>
</span></span><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&lt;stdio.h&gt;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&#34;freertos/FreeRTOS.h&#34;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&#34;freertos/task.h&#34;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&#34;driver/gpio.h&#34;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&#34;esp_log.h&#34;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&#34;led_strip.h&#34;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&#34;sdkconfig.h&#34;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp"></span>
</span></span><span class="line"><span class="cl"><span class="cp">#define BLINK_GPIO 12
</span></span></span><span class="line"><span class="cl"><span class="cp">#define GPIO_MODE_OUTPUT 1
</span></span></span><span class="line"><span class="cl"><span class="cp">#define CONFIG_BLINK_PERIOD 1000
</span></span></span><span class="line"><span class="cl"><span class="cp"></span>
</span></span><span class="line"><span class="cl"><span class="k">extern</span> <span class="kt">uint8_t</span> <span class="n">s_led_state</span><span class="p">;</span>  <span class="c1">// 这里 用extern, 不用 static
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">extern</span> <span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">TAG</span><span class="p">;</span>      <span class="c1">// 这里 用extern, 不用 static
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl"><span class="kt">void</span> <span class="nf">blink_led</span><span class="p">(</span><span class="kt">void</span><span class="p">);</span>     <span class="c1">// 这里只声明函数，不用 static
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kt">void</span> <span class="nf">configure_led</span><span class="p">(</span><span class="kt">void</span><span class="p">);</span> <span class="c1">// 这里只声明函数，不用 static
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl"><span class="cp">#endif </span><span class="cm">/* ME_H */</span><span class="cp">
</span></span></span></code></pre></div><p><strong>在源文件 <code>me.c</code> 中定义函数：</strong></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&#34;me.h&#34;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp"></span>
</span></span><span class="line"><span class="cl"><span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">TAG</span> <span class="o">=</span> <span class="s">&#34;example&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="kt">uint8_t</span> <span class="n">s_led_state</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>     <span class="c1">// 定义和初始化后, main.c 也可使用该值
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl"><span class="kt">void</span> <span class="nf">blink_led</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="cm">/* Set the GPIO level according to the state (LOW or HIGH) */</span>
</span></span><span class="line"><span class="cl">    <span class="nf">gpio_set_level</span><span class="p">(</span><span class="n">BLINK_GPIO</span><span class="p">,</span> <span class="n">s_led_state</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kt">void</span> <span class="nf">configure_led</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nf">ESP_LOGI</span><span class="p">(</span><span class="n">TAG</span><span class="p">,</span> <span class="s">&#34;Example configured to blink GPIO LED!&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="nf">gpio_reset_pin</span><span class="p">(</span><span class="n">BLINK_GPIO</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="cm">/* Set the GPIO as a push/pull output */</span>
</span></span><span class="line"><span class="cl">    <span class="nf">gpio_set_direction</span><span class="p">(</span><span class="n">BLINK_GPIO</span><span class="p">,</span> <span class="n">GPIO_MODE_OUTPUT</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div></blockquote>
<h4 id="faq2-添加-include-scr-文件夹使项目文件更简洁">FAQ2: 添加 include 、scr 文件夹，使项目文件更简洁<a hidden class="heading-anchor" aria-hidden="true" href="#faq2-添加-include-scr-文件夹使项目文件更简洁">#</a></h4>
<pre tabindex="0"><code>如何添加 include 、scr 文件夹，以使项目文件组织更专业简洁？
</code></pre><blockquote>
<p>项目中，如果你希望将 <code>main</code> 文件夹下的头文件和源文件管理得更有组织，可以在 <code>main</code> 文件夹内创建一个 <code>include</code> 文件夹来存放头文件，并将源文件（如 <code>.c</code> 文件）放在 <code>src</code> 文件夹中。你的目录结构可以调整为：</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-css" data-lang="css"><span class="line"><span class="cl"><span class="o">.</span>
</span></span><span class="line"><span class="cl"><span class="err">├──</span> <span class="nt">CMakeLists</span><span class="p">.</span><span class="nc">txt</span>
</span></span><span class="line"><span class="cl"><span class="err">├──</span> <span class="nt">README</span><span class="p">.</span><span class="nc">md</span>
</span></span><span class="line"><span class="cl"><span class="err">├──</span> <span class="nt">dependencies</span><span class="p">.</span><span class="nc">lock</span>
</span></span><span class="line"><span class="cl"><span class="err">└──</span> <span class="nt">main</span>
</span></span><span class="line"><span class="cl"> <span class="err">├──</span> <span class="nt">CMakeLists</span><span class="p">.</span><span class="nc">txt</span>
</span></span><span class="line"><span class="cl">    <span class="err">├──</span> <span class="nt">include</span>
</span></span><span class="line"><span class="cl">    <span class="err">│</span>   <span class="err">├──</span> <span class="nt">base_callbacks</span><span class="p">.</span><span class="nc">h</span>
</span></span><span class="line"><span class="cl">    <span class="err">│</span>   <span class="err">├──</span> <span class="nt">base_gui</span><span class="p">.</span><span class="nc">h</span>
</span></span><span class="line"><span class="cl">    <span class="err">│</span>   <span class="err">└──</span> <span class="nt">base_include</span><span class="p">.</span><span class="nc">h</span>
</span></span><span class="line"><span class="cl">    <span class="err">├──</span> <span class="nt">src</span>
</span></span><span class="line"><span class="cl">    <span class="err">│</span>   <span class="err">├──</span> <span class="nt">base_callbacks</span><span class="p">.</span><span class="nc">c</span>
</span></span><span class="line"><span class="cl">    <span class="err">│</span>   <span class="err">├──</span> <span class="nt">base_gui</span><span class="p">.</span><span class="nc">c</span>
</span></span><span class="line"><span class="cl">    <span class="err">│</span>   <span class="err">└──</span> <span class="nt">main</span><span class="p">.</span><span class="nc">c</span>
</span></span><span class="line"><span class="cl">    <span class="err">└──</span> <span class="nt">idf_component</span><span class="p">.</span><span class="nc">yml</span>
</span></span></code></pre></div><p>在这里，<code>include</code> 文件夹包含所有的头文件，而 <code>src</code> 文件夹包含所有的源文件。你可以根据需要调整头文件和源文件的位置。</p>
<p>另外，记得在 <code>main/CMakeLists.txt</code> 中调整文件路径，以确保编译器可以找到新的 <code>include</code> 和 <code>src</code> 文件夹。例如：</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-cmake" data-lang="cmake"><span class="line"><span class="cl"><span class="nb">idf_component_register</span><span class="p">(</span>
</span></span><span class="line"><span class="cl"> <span class="s">SRCS</span> <span class="s2">&#34;src/base_callbacks.c&#34;</span> <span class="s2">&#34;src/base_gui.c&#34;</span> <span class="s2">&#34;src/main.c&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="s">INCLUDE_DIRS</span> <span class="s2">&#34;include&#34;</span>
</span></span><span class="line"><span class="cl">   <span class="p">)</span><span class="err">
</span></span></span></code></pre></div><p>这样设置之后，CMake 构建系统会正确地包含头文件和源文件。</p></blockquote>
<p>(↑ updated on 2024-07-30 09:22:40)</p>
<hr>
<h1 id="split-your-cpp-code-into-multiple-files">split your cpp code into multiple files<a hidden class="heading-anchor" aria-hidden="true" href="#split-your-cpp-code-into-multiple-files">#</a></h1>
<p>reference: <a href="http://cse230.artifice.cc/lecture/splitting-code.html">http://cse230.artifice.cc/lecture/splitting-code.html</a></p>
<h2 id="understande-the-include">understande the #include<a hidden class="heading-anchor" aria-hidden="true" href="#understande-the-include">#</a></h2>
<p>The compiler will substitute #include <xyz> with the actual contents of the file xyz.</p>
<h2 id="the-header-files">the header files<a hidden class="heading-anchor" aria-hidden="true" href="#the-header-files">#</a></h2>
<p>the <code>.h</code> file is called the header files. People often use the header file as the one included.
Header files usually have the ending .h and source files usually have the ending .cpp</p>
<p>A header file contains only class and function <code>declarations</code>.</p>
<p>Note:
the declaration is a statement that a class exists and has certain properties and methods, or that a function exists;
neither the class methods nor the functions will be defined;
their implementations will not be provided in the header file.</p>
<p>We also need to prevent repeated-includes because the compiler is not happy when a class or function or variable of the same name is declared twice.</p>
<h2 id="the-frequent-ifndef-xxx_h-define-xxx_h-and-endif">The frequent <code>#ifndef XXX_H</code>, <code>#define XXX_H</code> and <code>#endif</code><a hidden class="heading-anchor" aria-hidden="true" href="#the-frequent-ifndef-xxx_h-define-xxx_h-and-endif">#</a></h2>
<p>Because the compiler is not happy when a class or function or variable of the same name is declared twice. Thus, in every header file (named blah.h in this example), we write the following at the top and bottom:</p>
<pre><code>```
#ifndef BLAH_H
#define BLAH_H

...

#endif
```
</code></pre>
<p>This means “if the name BLAH_H is not already defined, then define it.” If a file is included twice, then BLAH_H will be defined (by the first inclusion) so the entire “if—endif” will be skipped (which is the whole file, because the whole file is between the “if” and “endif”). Of course, BLAH_H can be anything; it could be FOO; we usually write FILE_H in the file named file.h so that we don’t reuse names.</p>
<h2 id="example">Example<a hidden class="heading-anchor" aria-hidden="true" href="#example">#</a></h2>
<p>files in structure:</p>
<ul>
<li>
<p>main.cpp</p>
<ul>
<li>
<p>eclipse.h (eclipse.cpp)</p>
<ul>
<li>shape.h</li>
</ul>
</li>
<li>
<p>rectangle.h (eclipse.cpp)</p>
<ul>
<li>shape.h</li>
</ul>
</li>
</ul>
</li>
</ul>
<hr>
<ul>
<li>main.cpp:</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&lt;iostream&gt;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&#34;rectangle.h&#34;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&#34;eclipse.h&#34;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp"></span><span class="k">using</span> <span class="k">namespace</span> <span class="n">std</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">main</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">Rectangle</span> <span class="n">r</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">r</span><span class="p">.</span><span class="n">width</span> <span class="o">=</span> <span class="mi">10</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">r</span><span class="p">.</span><span class="n">height</span> <span class="o">=</span> <span class="mi">15</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">r</span><span class="p">.</span><span class="n">x</span> <span class="o">=</span> <span class="mi">3</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">r</span><span class="p">.</span><span class="n">y</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">r</span><span class="p">.</span><span class="n">area</span><span class="p">()</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">Ellipse</span> <span class="n">e</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">e</span><span class="p">.</span><span class="n">major_axis</span> <span class="o">=</span> <span class="mi">3</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">e</span><span class="p">.</span><span class="n">minor_axis</span> <span class="o">=</span> <span class="mi">5</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">e</span><span class="p">.</span><span class="n">x</span> <span class="o">=</span> <span class="mi">14</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">e</span><span class="p">.</span><span class="n">y</span> <span class="o">=</span> <span class="mi">68</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">e</span><span class="p">.</span><span class="n">area</span><span class="p">()</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><ul>
<li>rectangle.h</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="cp">#ifndef RECTANGLE_H
</span></span></span><span class="line"><span class="cl"><span class="cp">#define RECTANGLE_H
</span></span></span><span class="line"><span class="cl"><span class="cp"></span>
</span></span><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&#34;shape.h&#34;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp"></span>
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">Rectangle</span> <span class="o">:</span> <span class="k">public</span> <span class="n">Shape</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">public</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">    <span class="kt">double</span> <span class="n">width</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kt">double</span> <span class="n">height</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="kt">double</span> <span class="nf">area</span><span class="p">();</span>
</span></span><span class="line"><span class="cl"><span class="p">};</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="cp">#endif
</span></span></span></code></pre></div><ul>
<li>
<p>rectangle.cpp:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&#34;rectangle.h&#34;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp"></span><span class="kt">double</span> <span class="n">Rectangle</span><span class="o">::</span><span class="n">area</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">width</span> <span class="o">*</span> <span class="n">height</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div></li>
<li>
<p>eclipse.h</p>
</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="cp">#ifndef ELLIPSE_H
</span></span></span><span class="line"><span class="cl"><span class="cp">#define ELLIPSE_H
</span></span></span><span class="line"><span class="cl"><span class="cp"></span>
</span></span><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&#34;shape.h&#34;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp"></span>
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">Ellipse</span> <span class="o">:</span> <span class="k">public</span> <span class="n">Shape</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">public</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">    <span class="kt">double</span> <span class="n">major_axis</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kt">double</span> <span class="n">minor_axis</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl">    <span class="kt">double</span> <span class="nf">area</span><span class="p">();</span>
</span></span><span class="line"><span class="cl"><span class="p">};</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="cp">#endif
</span></span></span></code></pre></div><ul>
<li>
<p>ellipse.cpp:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&#34;ellipse.h&#34;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp"></span><span class="kt">double</span> <span class="n">Ellipse</span><span class="o">::</span><span class="n">area</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="mf">3.1415926</span> <span class="o">*</span> <span class="n">major_axis</span> <span class="o">*</span> <span class="n">minor_axis</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div></li>
<li>
<p>shape.h:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="cp">#ifndef SHAPE_H
</span></span></span><span class="line"><span class="cl"><span class="cp">#define SHAPE_H
</span></span></span><span class="line"><span class="cl"><span class="cp"></span>
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">Shape</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">public</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">    <span class="kt">double</span> <span class="n">x</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kt">double</span> <span class="n">y</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">virtual</span> <span class="kt">double</span> <span class="nf">area</span><span class="p">()</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">};</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="cp">#endif
</span></span></span></code></pre></div></li>
</ul>
<h3 id="another-example">another example:<a hidden class="heading-anchor" aria-hidden="true" href="#another-example">#</a></h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">代码的头文件组织。
</span></span><span class="line"><span class="cl">It cost me much time and a deep night, so it&#39;s worthwhile to read it slowly.
</span></span><span class="line"><span class="cl">===========================================================
</span></span><span class="line"><span class="cl">    need to test the tutorial: https://cppguide.readthedocs.io/en/latest/cpp/multifile.html
</span></span><span class="line"><span class="cl">    when-to-use-extern-in-c: https://stackoverflow.com/questions/10422034/when-to-use-extern-in-c
</span></span><span class="line"><span class="cl">    C语言在头文件定义全局变量的技巧: https://blog.csdn.net/a1598025967/article/details/105876724
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    #ifndef HEADER_FILE 
</span></span><span class="line"><span class="cl">    #define HEADER_FILE
</span></span><span class="line"><span class="cl">        the entire header file file 
</span></span><span class="line"><span class="cl">    #endif
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    https://edisciplinas.usp.br/pluginfile.php/5453726/mod_resource/content/0/Extern%20Global%20Variable.pdf : 
</span></span><span class="line"><span class="cl">    # Best way to declare and define global variables
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    The clean, reliable way to declare and define global variables is to use a header file to contain
</span></span><span class="line"><span class="cl">    an extern declaration of the variable.
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    The header is included by the one source file that defines the variable and by all the source
</span></span><span class="line"><span class="cl">    files that reference the variable. For each program, one source file (and only one source file)
</span></span><span class="line"><span class="cl">    defines the variable. Similarly, one header file (and only one header file) should declare the
</span></span><span class="line"><span class="cl">    variable. The header file is crucial; it enables cross-checking between independent TUs
</span></span><span class="line"><span class="cl">    (translation units — think source files) and ensures consistency.
</span></span><span class="line"><span class="cl">    Although there are other ways of doing it, this method is simple and reliable. It is demonstrated
</span></span><span class="line"><span class="cl">    by file3.h, file1.c and file2.c:
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    ---- file3.h ---- 
</span></span><span class="line"><span class="cl">    extern int global_variable; /* Declaration of the variable */
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    ---- file1.c ---- 
</span></span><span class="line"><span class="cl">    #include &#34;file3.h&#34; /* Declaration made available here */
</span></span><span class="line"><span class="cl">    #include &#34;prog1.h&#34; /* Function declarations */
</span></span><span class="line"><span class="cl">    /* Variable defined here */
</span></span><span class="line"><span class="cl">    int global_variable = 37; /* Definition checked against declaration */
</span></span><span class="line"><span class="cl">    int increment(void) { return global_variable++; }
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    ----  file2.c ---- 
</span></span><span class="line"><span class="cl">    #include &#34;file3.h&#34;
</span></span><span class="line"><span class="cl">    #include &#34;prog1.h&#34;
</span></span><span class="line"><span class="cl">    #include &lt;stdio.h&gt;
</span></span><span class="line"><span class="cl">    void use_it(void)
</span></span><span class="line"><span class="cl">    {
</span></span><span class="line"><span class="cl">        printf(&#34;Global variable: %d\n&#34;, global_variable++);
</span></span><span class="line"><span class="cl">    }
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    ===================
</span></span><span class="line"><span class="cl">    That&#39;s the best way to declare and define global variables.
</span></span></code></pre></div>


        
      </article>
    </div>

    
      <div class="meta article-card">
    <div class="row">
      <span class="label">



<svg xmlns='http://www.w3.org/2000/svg' class='ionicon' viewBox='0 0 512 512'><path d='M32 456a24 24 0 0024 24h400a24 24 0 0024-24V176H32zm320-244a4 4 0 014-4h40a4 4 0 014 4v40a4 4 0 01-4 4h-40a4 4 0 01-4-4zm0 80a4 4 0 014-4h40a4 4 0 014 4v40a4 4 0 01-4 4h-40a4 4 0 01-4-4zm-80-80a4 4 0 014-4h40a4 4 0 014 4v40a4 4 0 01-4 4h-40a4 4 0 01-4-4zm0 80a4 4 0 014-4h40a4 4 0 014 4v40a4 4 0 01-4 4h-40a4 4 0 01-4-4zm0 80a4 4 0 014-4h40a4 4 0 014 4v40a4 4 0 01-4 4h-40a4 4 0 01-4-4zm-80-80a4 4 0 014-4h40a4 4 0 014 4v40a4 4 0 01-4 4h-40a4 4 0 01-4-4zm0 80a4 4 0 014-4h40a4 4 0 014 4v40a4 4 0 01-4 4h-40a4 4 0 01-4-4zm-80-80a4 4 0 014-4h40a4 4 0 014 4v40a4 4 0 01-4 4h-40a4 4 0 01-4-4zm0 80a4 4 0 014-4h40a4 4 0 014 4v40a4 4 0 01-4 4h-40a4 4 0 01-4-4zM456 64h-55.92V32h-48v32H159.92V32h-48v32H56a23.8 23.8 0 00-24 23.77V144h448V87.77A23.8 23.8 0 00456 64z'/></svg>













Published At</span><time>2024-07-30 09:22 CST</time>
      
    </div>

    

    
      <div class="row social-share">
        <span class="label">















<svg xmlns='http://www.w3.org/2000/svg' class='ionicon' viewBox='0 0 512 512'><path d='M272 176v161h-32V176H92a12 12 0 00-12 12v280a12 12 0 0012 12h328a12 12 0 0012-12V188a12 12 0 00-12-12zM272 92.63l64 64L358.63 134 256 31.37 153.37 134 176 156.63l64-64V176h32V92.63z'/></svg>

Share with</span>
        
        
        <a
          target="_blank"
          title="share to reddit"
          rel="noopener noreferrer"
          aria-label="share split your cpp code into multiple files on reddit"
          href="https://reddit.com/submit?url=http%3a%2f%2flocalhost%3a1313%2fposts%2fp20210305145900%2f&title=split%20your%20cpp%20code%20into%20multiple%20files">
          









<svg xmlns='http://www.w3.org/2000/svg' class='ionicon' viewBox='0 0 512 512' fill="currentColor" stroke="currentColor" stroke-width="10"><path d='M324 256a36 36 0 1036 36 36 36 0 00-36-36z'/><circle cx='188' cy='292' r='36' transform='rotate(-22.5 187.997 291.992)'/><path d='M496 253.77c0-31.19-25.14-56.56-56-56.56a55.72 55.72 0 00-35.61 12.86c-35-23.77-80.78-38.32-129.65-41.27l22-79 66.41 13.2c1.9 26.48 24 47.49 50.65 47.49 28 0 50.78-23 50.78-51.21S441 48 413 48c-19.53 0-36.31 11.19-44.85 28.77l-90-17.89-31.1 109.52-4.63.13c-50.63 2.21-98.34 16.93-134.77 41.53A55.38 55.38 0 0072 197.21c-30.89 0-56 25.37-56 56.56a56.43 56.43 0 0028.11 49.06 98.65 98.65 0 00-.89 13.34c.11 39.74 22.49 77 63 105C146.36 448.77 199.51 464 256 464s109.76-15.23 149.83-42.89c40.53-28 62.85-65.27 62.85-105.06a109.32 109.32 0 00-.84-13.3A56.32 56.32 0 00496 253.77zM414 75a24 24 0 11-24 24 24 24 0 0124-24zM42.72 253.77a29.6 29.6 0 0129.42-29.71 29 29 0 0113.62 3.43c-15.5 14.41-26.93 30.41-34.07 47.68a30.23 30.23 0 01-8.97-21.4zM390.82 399c-35.74 24.59-83.6 38.14-134.77 38.14S157 423.61 121.29 399c-33-22.79-51.24-52.26-51.24-83A78.5 78.5 0 0175 288.72c5.68-15.74 16.16-30.48 31.15-43.79a155.17 155.17 0 0114.76-11.53l.3-.21.24-.17c35.72-24.52 83.52-38 134.61-38s98.9 13.51 134.62 38l.23.17.34.25A156.57 156.57 0 01406 244.92c15 13.32 25.48 28.05 31.16 43.81a85.44 85.44 0 014.31 17.67 77.29 77.29 0 01.6 9.65c-.01 30.72-18.21 60.19-51.25 82.95zm69.6-123.92c-7.13-17.28-18.56-33.29-34.07-47.72A29.09 29.09 0 01440 224a29.59 29.59 0 0129.41 29.71 30.07 30.07 0 01-8.99 21.39z'/><path d='M323.23 362.22c-.25.25-25.56 26.07-67.15 26.27-42-.2-66.28-25.23-67.31-26.27a4.14 4.14 0 00-5.83 0l-13.7 13.47a4.15 4.15 0 000 5.89c3.4 3.4 34.7 34.23 86.78 34.45 51.94-.22 83.38-31.05 86.78-34.45a4.16 4.16 0 000-5.9l-13.71-13.47a4.13 4.13 0 00-5.81 0z'/></svg>








        </a>
        <a
          target="_blank"
          title="share to twitter"
          rel="noopener noreferrer"
          aria-label="share split your cpp code into multiple files on twitter"
          href="https://twitter.com/intent/tweet/?text=split%20your%20cpp%20code%20into%20multiple%20files&amp;url=http%3a%2f%2flocalhost%3a1313%2fposts%2fp20210305145900%2f&amp;hashtags=">
          










<svg class="ionicon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" style="fill:none;" stroke="currentColor" stroke-width="2"><path d="M23 3a10.9 10.9 0 0 1-3.14 1.53 4.48 4.48 0 0 0-7.86 3v1A10.66 10.66 0 0 1 3 4s-4 9 5 13a11.64 11.64 0 0 1-7 2c9 5 20 0 20-11.5a4.5 4.5 0 0 0-.08-.83A7.72 7.72 0 0 0 23 3z"></path></svg>







        </a>
        <a
          target="_blank"
          title="share to facebook"
          rel="noopener noreferrer"
          aria-label="share split your cpp code into multiple files on facebook"
          href="https://facebook.com/sharer/sharer.php?u=http%3a%2f%2flocalhost%3a1313%2fposts%2fp20210305145900%2f">
          








<svg xmlns="http://www.w3.org/2000/svg" class="ionicon" viewBox="0 0 24 24" style="fill:none;" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-facebook"><path d="M18 2h-3a5 5 0 0 0-5 5v3H7v4h3v8h4v-8h3l1-4h-4V7a1 1 0 0 1 1-1h3z"></path></svg>









        </a>
      </div>
    

    
</div>

    

    

  </div>
</main>

  </main>
  <footer>
    <footer id="footer">
  <div class="container has-padding is-flex">
    <ul class="links">
      
      <li>
        </li>
      <li>
        <a
          rel="nofollow"
          target="_blank"
          href="https://github.com/wayjam/hugo-theme-fluency"
          title="using Hugo theme fluency">
          Theme Fluency
        </a>
      </li>
      <li>
        <a rel="nofollow" target="_blank" href="https://gohugo.io" title="Built with hugo">Built with Hugo</a>
      </li>
    </ul>
    <div class="copyright">
       &copy; 2025 Combine Art and Sciences
      
    </div>
  </div>
</footer>

<script>
    window.FluencyCopyIcon = '\n\n\n\n\n\n\n\u003csvg xmlns=\u0027http:\/\/www.w3.org\/2000\/svg\u0027 class=\u0027ionicon\u0027 viewBox=\u00270 0 512 512\u0027\u003e\u003crect x=\u0027128\u0027 y=\u0027128\u0027 width=\u0027336\u0027 height=\u0027336\u0027 rx=\u002757\u0027 ry=\u002757\u0027 stroke-linejoin=\u0027round\u0027 class=\u0027ionicon-fill-none ionicon-stroke-width\u0027\/\u003e\u003cpath d=\u0027M383.5 128l.5-24a56.16 56.16 0 00-56-56H112a64.19 64.19 0 00-64 64v216a56.16 56.16 0 0056 56h24\u0027 stroke-linecap=\u0027round\u0027 stroke-linejoin=\u0027round\u0027 class=\u0027ionicon-fill-none ionicon-stroke-width\u0027\/\u003e\u003c\/svg\u003e\n\n\n\n\n\n\n\n\n\n\n'
</script>


<script defer src="http://localhost:1313/js/main.min.15ea6de828b83519cdc1bc66872563a50cd5e59b4b1cfc6f31019951922b2e78.js" integrity="sha256-Fept6Ci4NRnNwbxmhyVjpQzV5ZtLHPxvMQGZUZIrLng=" crossorigin="anonymous" async></script>


    <link
  rel="stylesheet"
  href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css"
  integrity="sha384-AfEj0r4/OFrOo5t7NnNe46zW/tFgW6x/bCJG8FqQCEo3+Aro6EYUG4+cU+KJWu/X"
  crossorigin="anonymous"
/>


<script
  defer
  src="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.js"
  integrity="sha384-g7c+Jr9ZivxKLnZTDUhnkOnsh30B4H0rpLUpJ4jAIKs4fnJI+sEnkvrMWph2EDg4"
  crossorigin="anonymous"
></script>


<script
  defer
  src="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/contrib/auto-render.min.js"
  integrity="sha384-mll67QQFJfxn0IYznZYonOWZ644AWYC+Pt2cHqMaRhXVrursRwvLnLaebdGIlYNa"
  crossorigin="anonymous"
  onload="renderMathInElement(document.body);"
></script>



<noscript>
<style type=text/css>#theme-selector-button{display:none}</style>
</noscript>




  </footer>
</body>
</html>